size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
# 1. TDA A: Age
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_Age_TDA-A.pdf", width = 12)
sub10 %>%
mutate(age_cat_ext2 = fct_reorder(age_cat_ext2, Sum)) %>%
mutate(age_cat_ext2 = factor(age_cat_ext2, levels=c("< 2 years", "2 - < 5 years", "5 - 10 years", "> 10 years"))) %>%
ggplot(aes(fill=Outcome, y=Sum, x=age_cat_ext2)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 2. TDA A: HIV
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_HIV_TDA-A.pdf", width = 12)
sub10 %>%
mutate(hivstatus = fct_reorder(hivstatus, Sum)) %>%
mutate(hivstatus = factor(hivstatus, levels=c("HIV positive", "HIV negative", "Unknown"))) %>%
ggplot(aes(fill=Outcome, y=Sum, x=hivstatus)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 3. TDA A: SAM
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_SAM_TDA-A.pdf", width = 12)
sub10 %>%
mutate(sam = fct_reorder(sam, Sum)) %>%
mutate(sam = factor(sam, levels=c("SAM", "No SAM"))) %>%
ggplot(aes(fill=Outcome, y=Sum, x=sam)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 4. TDA A: High risk
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_HighRisk_TDA-A.pdf", width = 12)
sub10 %>%
mutate(high.risk = if_else(highrisk=="No", "Low risk", "High risk")) %>%
mutate(high.risk = fct_reorder(high.risk, Sum)) %>%
mutate(high.risk = factor(high.risk, levels=c("High risk", "Low risk"))) %>%
ggplot(aes(fill=Outcome, y=Sum, x=high.risk)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 5. TDA A: Site
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_Site_TDA-A.pdf", width = 12)
sub10 %>%
mutate(study = fct_reorder(study, Sum)) %>%
mutate(study = factor(study, levels=c("Cohort", "HIV", "RaPaed", "UMOYA"))) %>%
ggplot(aes(fill=Outcome, y=Sum, x=study)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
library(forcats)
library(hrbrthemes)
sub10 %>%
ggplot(aes(fill = Outcome, y = Sum_B, x = Outcome)) +
geom_violin(alpha = 0.5, outlier.colour = "transparent") +
geom_boxplot(position = position_dodge(width = 0.9), width = 0.2) +
scale_fill_manual(name = "Outcome", values = pal_union) +
scale_color_manual(name = "Outcome", values = pal_union) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
# 1. TDA A: Age
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_Age_TDA-B.pdf", width = 12)
sub10 %>%
mutate(age_cat_ext2 = fct_reorder(age_cat_ext2, Sum_B)) %>%
mutate(age_cat_ext2 = factor(age_cat_ext2, levels=c("< 2 years", "2 - < 5 years", "5 - 10 years", "> 10 years"))) %>%
ggplot(aes(fill=Outcome, y=Sum_B, x=age_cat_ext2)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union_b) +
scale_color_manual(name = "Outcome", values = pal_union_b) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 2. TDA A: HIV
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_HIV_TDA-B.pdf", width = 12)
sub10 %>%
mutate(hivstatus = fct_reorder(hivstatus, Sum_B)) %>%
mutate(hivstatus = factor(hivstatus, levels=c("HIV positive", "HIV negative", "Unknown"))) %>%
ggplot(aes(fill=Outcome, y=Sum_B, x=hivstatus)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union_b) +
scale_color_manual(name = "Outcome", values = pal_union_b) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 3. TDA A: SAM
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_SAM_TDA-B.pdf", width = 12)
sub10 %>%
mutate(sam = fct_reorder(sam, Sum_B)) %>%
mutate(sam = factor(sam, levels=c("SAM", "No SAM"))) %>%
ggplot(aes(fill=Outcome, y=Sum_B, x=sam)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union_b) +
scale_color_manual(name = "Outcome", values = pal_union_b) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 4. TDA A: High risk
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_HighRisk_TDA-B.pdf", width = 12)
sub10 %>%
mutate(high.risk = if_else(highrisk=="No", "Low risk", "High risk")) %>%
mutate(high.risk = fct_reorder(high.risk, Sum_B)) %>%
mutate(high.risk = factor(high.risk, levels=c("High risk", "Low risk"))) %>%
ggplot(aes(fill=Outcome, y=Sum_B, x=high.risk)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union_b) +
scale_color_manual(name = "Outcome", values = pal_union_b) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
# 5. TDA B: High risk
pdf("/Users/lshlf15/Desktop/Decide-TB_Raincloud_Site_TDA-B.pdf", width = 12)
sub10 %>%
mutate(study = fct_reorder(study, Sum_B)) %>%
mutate(study = factor(study, levels=c("Cohort", "HIV", "RaPaed", "UMOYA"))) %>%
ggplot(aes(fill=Outcome, y=Sum_B, x=study)) +
geom_violin(alpha=0.5, outlier.colour="transparent") +
geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
scale_fill_manual(name = "Outcome", values = pal_union_b) +
scale_color_manual(name = "Outcome", values = pal_union_b) +
theme_minimal() +
theme(axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14)) +
xlab("") +
ylab("TDA score") +
coord_flip() +
stat_summary(
geom = "text",
fun.data = add_sample,
aes(label = paste("n =", ..label..),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
size = 6,
hjust = 0.75,
vjust = 2.5,
position = position_dodge(width = 0.9)
) +
stat_summary(
geom = "text",
fun = "median",
aes(label = round(..y.., 2),
color = Outcome,
color = after_scale(darken(color, .1, space = "HLS"))),
family = "Helvetica",
fontface = "bold",
size = 6,
hjust = 1.05,
vjust = -0.75,
position = position_dodge(width = 0.9)
)
dev.off()
